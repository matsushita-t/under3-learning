
# 鍵認証の仕組み



## 暗号化の必要性

*そもそも暗号化は何故必要なのでしょうか。それはインターネットを経由して情報のやり取りを行う場合、悪意のある第三者に情報を盗み見される危険性があるためです。*

```bash
Aさん                           Bさん
◯--📄---------------------------->●
　　　　　　　└▲クラッカー
```

*そこで重要なデータについては送信する前に暗号化を行います。もし途中で悪意のある第三者にデータを盗み見されたとしてもデータは暗号化されているため悪意のある第三者はデータの内容を見ることは出来ません*。*
```bash
Aさん                           Bさん
◯--🔐---------------------------->●
　　　　　　　☓
　　　　　　　└▲クラッカー
```


## 共通鍵暗号

*共通鍵暗号は暗号化と復号化に同じ鍵を使う方式です。例えば受信側で暗号化・復号化用の鍵を作成し、同じ鍵のうちの1つの鍵を送信者側に送信しておきます。そして自分宛にデータを送信する場合は、渡した鍵で暗号化して送信して欲しいと依頼します。*

```bash
Aさん                           Bさん
◯🔑-------------------------------->●🔑
　　　　　　　☓
　　　　　　　└▲クラッカー
```

*そしてデータを送信する時にはまず送信側で鍵を使ってデータを暗号化します。*

```bash
Aさん                           Bさん
◯🔑--🔐---------------------------->●🔑
　　　　　　　☓
　　　　　　　└▲クラッカー
```

*暗号化したデータをインターネットを経由して送信して受信側で受けとったデータを鍵を使って
復号化します。データは暗号化されているので悪意のある第三者に盗み見られても安心です。*

***Pemファイルの共有やZIPファイルのパスワードも似たような話***


## 共通鍵暗号のリスク

*このように安全にデータを受け渡しすることができたように見えますが、共通鍵暗号方式の場合は実は2つの問題点があります。
まず一つ目は鍵をどのようにして相手に渡すのかです。同じ鍵を使用していますのでどちらかで作成した鍵を相手に渡す必要があります。ところが鍵をインターネット経由で渡した場合、鍵は暗号化されておらず鍵を悪意のある第三者に見られてしまう可能性があります。

```bash
Aさん                           Bさん
◯🔑-------------------------------->●🔑
　　　　　　　└▲クラッカー🔑
```

*悪意のある第三者に鍵を持たれてしまっては、いくらデータを暗号化して送信しても意味がありません。悪意のある第三者が鍵を持っているので暗号化したデータを復号化できてしまうためです。
よって共通鍵暗号方式だけを使う場合は、鍵の受け渡しをインターネット以外の例えば郵送といった手段で行う必要があります。もう一つの問題点は複数の相手から暗号化したデータを受け取る場合、相手毎に鍵を別に用意する必要があるということです。*

*もし同じ鍵を共通して使った場合を考えてみます。*
```bash
Aさん
◯🔑-----------------------Bさん🔑
　　　　　　　　　　　　　　　└Cさん🔑
　　　　　　　　　　　　　　　└Dさん🔑
　　　　　　　　　　　　　　　└Eさん🔑
```

*誰かから送信されたデータは暗号化されていますが、他の人も同じ鍵を持っていますのでもしデータが盗み見られてしまうとデータが復号化されて中身が見られてしまいます。*

*その為、データのやり取りをする相手ごとに別々の鍵を用意する必要があります。実用上はそれほど大きな問題ではありませんが、送信先が増加した場合は鍵の管理が煩雑になります。*